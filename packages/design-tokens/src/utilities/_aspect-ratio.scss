// Aspect Ratio Utilities
// Modern CSS aspect-ratio property with fallback support

@use 'sass:map';

// Aspect ratio map for common ratios
$aspect-ratios: (
  'square': '1 / 1',
  'video': '16 / 9', 
  'cinema': '21 / 9',
  'photo': '4 / 3',
  'portrait': '3 / 4',
  'golden': '1.618 / 1',
  'a4': '210 / 297',
  'wide': '2 / 1',
  'ultra-wide': '32 / 9'
);

// Mixin for generating aspect ratio styles
@mixin aspect-ratio-style($name, $ratio) {
  aspect-ratio: #{$ratio};
  
  // Fallback for browsers without aspect-ratio support
  @supports not (aspect-ratio: 1) {
    position: relative;
    
    &::before {
      content: '';
      display: block;
      width: 100%;
      
      @if $name == 'square' {
        padding-top: 100%;
      } @else if $name == 'video' {
        padding-top: 56.25%; // 9/16 * 100%
      } @else if $name == 'cinema' {
        padding-top: 42.857%; // 9/21 * 100%
      } @else if $name == 'photo' {
        padding-top: 75%; // 3/4 * 100%
      } @else if $name == 'portrait' {
        padding-top: 133.333%; // 4/3 * 100%
      } @else if $name == 'golden' {
        padding-top: 61.803%; // 1/1.618 * 100%
      } @else if $name == 'a4' {
        padding-top: 141.429%; // 297/210 * 100%
      } @else if $name == 'wide' {
        padding-top: 50%; // 1/2 * 100%
      } @else if $name == 'ultra-wide' {
        padding-top: 28.125%; // 9/32 * 100%
      }
    }
    
    > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

// Generate aspect ratio utilities
@each $name, $ratio in $aspect-ratios {
  .haspen-aspect-#{$name} {
    @include aspect-ratio-style($name, $ratio);
  }
}

// Custom aspect ratio utility with CSS custom property
.haspen-aspect-custom {
  aspect-ratio: var(--aspect-ratio, 1);
  
  // Fallback for browsers without aspect-ratio support
  @supports not (aspect-ratio: 1) {
    position: relative;
    
    &::before {
      content: '';
      display: block;
      width: 100%;
      padding-top: calc(100% / var(--aspect-ratio, 1));
    }
    
    > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

// Responsive aspect ratio utilities
@container (min-width: 24rem) {
  .haspen-cq-sm\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-cq-sm\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-cq-sm\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-cq-sm\:aspect-portrait { @include aspect-ratio-style('portrait', '3 / 4'); }
}

@container (min-width: 32rem) {
  .haspen-cq-md\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-cq-md\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-cq-md\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-cq-md\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-cq-md\:aspect-portrait { @include aspect-ratio-style('portrait', '3 / 4'); }
  .haspen-cq-md\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
}

@container (min-width: 48rem) {
  .haspen-cq-lg\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-cq-lg\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-cq-lg\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-cq-lg\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-cq-lg\:aspect-portrait { @include aspect-ratio-style('portrait', '3 / 4'); }
  .haspen-cq-lg\:aspect-golden { @include aspect-ratio-style('golden', '1.618 / 1'); }
  .haspen-cq-lg\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
  .haspen-cq-lg\:aspect-ultra-wide { @include aspect-ratio-style('ultra-wide', '32 / 9'); }
}

@container (min-width: 64rem) {
  .haspen-cq-xl\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-cq-xl\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-cq-xl\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-cq-xl\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-cq-xl\:aspect-portrait { @include aspect-ratio-style('portrait', '3 / 4'); }
  .haspen-cq-xl\:aspect-golden { @include aspect-ratio-style('golden', '1.618 / 1'); }
  .haspen-cq-xl\:aspect-a4 { @include aspect-ratio-style('a4', '210 / 297'); }
  .haspen-cq-xl\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
  .haspen-cq-xl\:aspect-ultra-wide { @include aspect-ratio-style('ultra-wide', '32 / 9'); }
}

// Media query variants for compatibility
@media (min-width: 640px) {
  .haspen-sm\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-sm\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-sm\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
}

@media (min-width: 768px) {
  .haspen-md\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-md\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-md\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-md\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-md\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
}

@media (min-width: 1024px) {
  .haspen-lg\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-lg\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-lg\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-lg\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-lg\:aspect-golden { @include aspect-ratio-style('golden', '1.618 / 1'); }
  .haspen-lg\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
  .haspen-lg\:aspect-ultra-wide { @include aspect-ratio-style('ultra-wide', '32 / 9'); }
}

@media (min-width: 1280px) {
  .haspen-xl\:aspect-square { @include aspect-ratio-style('square', '1 / 1'); }
  .haspen-xl\:aspect-video { @include aspect-ratio-style('video', '16 / 9'); }
  .haspen-xl\:aspect-cinema { @include aspect-ratio-style('cinema', '21 / 9'); }
  .haspen-xl\:aspect-photo { @include aspect-ratio-style('photo', '4 / 3'); }
  .haspen-xl\:aspect-golden { @include aspect-ratio-style('golden', '1.618 / 1'); }
  .haspen-xl\:aspect-a4 { @include aspect-ratio-style('a4', '210 / 297'); }
  .haspen-xl\:aspect-wide { @include aspect-ratio-style('wide', '2 / 1'); }
  .haspen-xl\:aspect-ultra-wide { @include aspect-ratio-style('ultra-wide', '32 / 9'); }
}